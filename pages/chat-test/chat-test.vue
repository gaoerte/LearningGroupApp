<template>
  <view class="chat-test-container">
    <!-- æ ‡é¢˜åŒºåŸŸ -->
    <view class="header-section">
      <text class="main-title">ğŸ’¬ èŠå¤©åŠŸèƒ½æµ‹è¯•</text>
      <text class="subtitle">æµ‹è¯•å®æ—¶èŠå¤©ã€æ¶ˆæ¯å‘é€ã€è¡¨æƒ…ç­‰åŠŸèƒ½</text>
    </view>

    <!-- åŠŸèƒ½æµ‹è¯•åŒºåŸŸ -->
    <view class="test-section">
      <text class="section-title">ğŸ§ª åŠŸèƒ½æµ‹è¯•</text>
      
      <view class="test-grid">
        <view class="test-item" @tap="testBasicChat">
          <text class="test-icon">ğŸ’¬</text>
          <text class="test-label">åŸºç¡€èŠå¤©</text>
          <text class="test-desc">æ–‡æœ¬æ¶ˆæ¯æ”¶å‘</text>
        </view>

        <view class="test-item" @tap="testImageChat">
          <text class="test-icon">ğŸ“·</text>
          <text class="test-label">å›¾ç‰‡èŠå¤©</text>
          <text class="test-desc">å›¾ç‰‡å‘é€é¢„è§ˆ</text>
        </view>

        <view class="test-item" @tap="testEmojiChat">
          <text class="test-icon">ğŸ˜Š</text>
          <text class="test-label">è¡¨æƒ…èŠå¤©</text>
          <text class="test-desc">è¡¨æƒ…é¢æ¿åŠŸèƒ½</text>
        </view>

        <view class="test-item" @tap="testGroupChat">
          <text class="test-icon">ğŸ‘¥</text>
          <text class="test-label">ç¾¤ç»„èŠå¤©</text>
          <text class="test-desc">å¤šäººèŠå¤©å®¤</text>
        </view>
      </view>
    </view>

    <!-- å¿«é€Ÿæµ‹è¯• -->
    <view class="quick-test-section">
      <text class="section-title">âš¡ å¿«é€Ÿæµ‹è¯•</text>
      
      <view class="quick-actions">
        <button class="quick-btn primary" @tap="startQuickTest">
          å¼€å§‹å¿«é€Ÿæµ‹è¯•
        </button>
        <button class="quick-btn secondary" @tap="viewChatDemo">
          æŸ¥çœ‹èŠå¤©æ¼”ç¤º
        </button>
      </view>
    </view>

    <!-- æµ‹è¯•è¯´æ˜ -->
    <view class="instruction-section">
      <text class="section-title">ğŸ“‹ æµ‹è¯•è¯´æ˜</text>
      
      <view class="instruction-list">
        <view class="instruction-item">
          <text class="step-number">1</text>
          <text class="step-text">ç‚¹å‡»"åŸºç¡€èŠå¤©"è¿›å…¥èŠå¤©é¡µé¢</text>
        </view>
        <view class="instruction-item">
          <text class="step-number">2</text>
          <text class="step-text">åœ¨è¾“å…¥æ¡†è¾“å…¥æ¶ˆæ¯å¹¶å‘é€</text>
        </view>
        <view class="instruction-item">
          <text class="step-number">3</text>
          <text class="step-text">æµ‹è¯•è¡¨æƒ…é¢æ¿å’Œå›¾ç‰‡å‘é€</text>
        </view>
        <view class="instruction-item">
          <text class="step-number">4</text>
          <text class="step-text">æŸ¥çœ‹æ¶ˆæ¯æ˜¾ç¤ºå’Œè‡ªåŠ¨å›å¤</text>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½ç‰¹ç‚¹ -->
    <view class="features-section">
      <text class="section-title">âœ¨ åŠŸèƒ½ç‰¹ç‚¹</text>
      
      <view class="feature-list">
        <view class="feature-item">
          <text class="feature-icon">ğŸ’¬</text>
          <text class="feature-text">å®æ—¶æ¶ˆæ¯æ”¶å‘</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">ğŸ“±</text>
          <text class="feature-text">å“åº”å¼èŠå¤©ç•Œé¢</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">ğŸ˜Š</text>
          <text class="feature-text">ä¸°å¯Œè¡¨æƒ…æ”¯æŒ</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">ğŸ“·</text>
          <text class="feature-text">å›¾ç‰‡æ¶ˆæ¯å‘é€</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">â°</text>
          <text class="feature-text">æ¶ˆæ¯æ—¶é—´æ˜¾ç¤º</text>
        </view>
        <view class="feature-item">
          <text class="feature-icon">ğŸ‘¤</text>
          <text class="feature-text">ç”¨æˆ·å¤´åƒæ˜¾ç¤º</text>
        </view>
      </view>
    </view>

    <!-- è¿”å›æŒ‰é’® -->
    <view class="back-section">
      <button class="back-btn" @tap="goBack">
        è¿”å›é¦–é¡µ
      </button>
    </view>
  </view>
</template>

<script>
export default {
  name: 'ChatTest',
  methods: {
    // æµ‹è¯•åŸºç¡€èŠå¤©
    testBasicChat() {
      uni.navigateTo({
        url: '/pages/chat/chat?chatName=åŸºç¡€èŠå¤©æµ‹è¯•&chatId=test_basic',
        success: () => {
          console.log('[èŠå¤©æµ‹è¯•] è·³è½¬åŸºç¡€èŠå¤©æµ‹è¯•')
        },
        fail: (error) => {
          console.error('[èŠå¤©æµ‹è¯•] è·³è½¬å¤±è´¥:', error)
          uni.showToast({
            title: 'è·³è½¬å¤±è´¥',
            icon: 'none'
          })
        }
      })
    },

    // æµ‹è¯•å›¾ç‰‡èŠå¤©
    testImageChat() {
      uni.navigateTo({
        url: '/pages/chat/chat?chatName=å›¾ç‰‡èŠå¤©æµ‹è¯•&chatId=test_image',
        success: () => {
          console.log('[èŠå¤©æµ‹è¯•] è·³è½¬å›¾ç‰‡èŠå¤©æµ‹è¯•')
          // æç¤ºç”¨æˆ·æµ‹è¯•å›¾ç‰‡åŠŸèƒ½
          setTimeout(() => {
            uni.showModal({
              title: 'æç¤º',
              content: 'è¿›å…¥èŠå¤©åï¼Œç‚¹å‡»ç›¸æœºå›¾æ ‡ğŸ“·æµ‹è¯•å›¾ç‰‡å‘é€åŠŸèƒ½',
              showCancel: false
            })
          }, 1000)
        }
      })
    },

    // æµ‹è¯•è¡¨æƒ…èŠå¤©
    testEmojiChat() {
      uni.navigateTo({
        url: '/pages/chat/chat?chatName=è¡¨æƒ…èŠå¤©æµ‹è¯•&chatId=test_emoji',
        success: () => {
          console.log('[èŠå¤©æµ‹è¯•] è·³è½¬è¡¨æƒ…èŠå¤©æµ‹è¯•')
          // æç¤ºç”¨æˆ·æµ‹è¯•è¡¨æƒ…åŠŸèƒ½
          setTimeout(() => {
            uni.showModal({
              title: 'æç¤º',
              content: 'è¿›å…¥èŠå¤©åï¼Œç‚¹å‡»ç¬‘è„¸å›¾æ ‡ğŸ˜Šæµ‹è¯•è¡¨æƒ…é¢æ¿åŠŸèƒ½',
              showCancel: false
            })
          }, 1000)
        }
      })
    },

    // æµ‹è¯•ç¾¤ç»„èŠå¤©
    testGroupChat() {
      uni.navigateTo({
        url: '/pages/chat/chat?chatName=ç¾¤ç»„èŠå¤©æµ‹è¯•&chatId=test_group',
        success: () => {
          console.log('[èŠå¤©æµ‹è¯•] è·³è½¬ç¾¤ç»„èŠå¤©æµ‹è¯•')
        }
      })
    },

    // å¼€å§‹å¿«é€Ÿæµ‹è¯•
    startQuickTest() {
      uni.showModal({
        title: 'å¿«é€Ÿæµ‹è¯•',
        content: 'å°†ä¾æ¬¡æµ‹è¯•æ‰€æœ‰èŠå¤©åŠŸèƒ½ï¼Œç¡®å®šå¼€å§‹å—ï¼Ÿ',
        success: (res) => {
          if (res.confirm) {
            this.runQuickTest()
          }
        }
      })
    },

    // æ‰§è¡Œå¿«é€Ÿæµ‹è¯•
    runQuickTest() {
      const tests = [
        { name: 'åŸºç¡€èŠå¤©', delay: 0 },
        { name: 'è¡¨æƒ…åŠŸèƒ½', delay: 2000 },
        { name: 'å›¾ç‰‡åŠŸèƒ½', delay: 4000 }
      ]

      tests.forEach((test, index) => {
        setTimeout(() => {
          uni.showToast({
            title: `æµ‹è¯•${test.name}...`,
            icon: 'none',
            duration: 1500
          })
          
          if (index === tests.length - 1) {
            setTimeout(() => {
              this.testBasicChat()
            }, 1500)
          }
        }, test.delay)
      })
    },

    // æŸ¥çœ‹èŠå¤©æ¼”ç¤º
    viewChatDemo() {
      uni.showModal({
        title: 'èŠå¤©æ¼”ç¤º',
        content: 'èŠå¤©åŠŸèƒ½åŒ…å«ï¼š\nâ€¢ æ–‡æœ¬æ¶ˆæ¯å‘é€\nâ€¢ å›¾ç‰‡åˆ†äº«\nâ€¢ è¡¨æƒ…æ”¯æŒ\nâ€¢ è‡ªåŠ¨å›å¤\nâ€¢ æ¶ˆæ¯æ—¶é—´\nâ€¢ ç”¨æˆ·å¤´åƒ',
        showCancel: false,
        confirmText: 'ç«‹å³ä½“éªŒ',
        success: (res) => {
          if (res.confirm) {
            this.testBasicChat()
          }
        }
      })
    },

    // è¿”å›é¦–é¡µ
    goBack() {
      uni.switchTab({
        url: '/pages/index/index'
      })
    }
  }
}
</script>

<style lang="scss" scoped>
.chat-test-container {
  min-height: 100vh;
  background: #f8fafc;
  padding: 32rpx;
}

.header-section {
  text-align: center;
  margin-bottom: 48rpx;
  
  .main-title {
    font-size: 48rpx;
    font-weight: bold;
    color: #1f2937;
    display: block;
    margin-bottom: 16rpx;
  }
  
  .subtitle {
    font-size: 28rpx;
    color: #6b7280;
  }
}

.section-title {
  font-size: 36rpx;
  font-weight: 600;
  color: #374151;
  display: block;
  margin-bottom: 32rpx;
}

.test-section {
  background: white;
  border-radius: 16rpx;
  padding: 32rpx;
  margin-bottom: 32rpx;
  box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.1);
  
  .test-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24rpx;
    
    .test-item {
      padding: 32rpx 24rpx;
      border: 2rpx solid #e5e7eb;
      border-radius: 12rpx;
      text-align: center;
      transition: all 0.3s ease;
      
      &:active {
        background: #f3f4f6;
        transform: scale(0.98);
        border-color: #667eea;
      }
      
      .test-icon {
        font-size: 56rpx;
        display: block;
        margin-bottom: 16rpx;
      }
      
      .test-label {
        font-size: 32rpx;
        font-weight: 600;
        color: #1f2937;
        display: block;
        margin-bottom: 8rpx;
      }
      
      .test-desc {
        font-size: 24rpx;
        color: #6b7280;
      }
    }
  }
}

.quick-test-section {
  background: white;
  border-radius: 16rpx;
  padding: 32rpx;
  margin-bottom: 32rpx;
  box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.1);
  
  .quick-actions {
    display: flex;
    gap: 24rpx;
    
    .quick-btn {
      flex: 1;
      padding: 24rpx;
      border-radius: 12rpx;
      border: none;
      font-size: 32rpx;
      font-weight: 600;
      
      &.primary {
        background: #667eea;
        color: white;
      }
      
      &.secondary {
        background: #f3f4f6;
        color: #374151;
      }
    }
  }
}

.instruction-section {
  background: white;
  border-radius: 16rpx;
  padding: 32rpx;
  margin-bottom: 32rpx;
  box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.1);
  
  .instruction-list {
    .instruction-item {
      display: flex;
      align-items: center;
      margin-bottom: 24rpx;
      
      &:last-child {
        margin-bottom: 0;
      }
      
      .step-number {
        width: 48rpx;
        height: 48rpx;
        border-radius: 50%;
        background: #667eea;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24rpx;
        font-weight: bold;
        margin-right: 24rpx;
        flex-shrink: 0;
      }
      
      .step-text {
        font-size: 28rpx;
        color: #374151;
        line-height: 1.5;
      }
    }
  }
}

.features-section {
  background: white;
  border-radius: 16rpx;
  padding: 32rpx;
  margin-bottom: 32rpx;
  box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.1);
  
  .feature-list {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24rpx;
    
    .feature-item {
      display: flex;
      align-items: center;
      padding: 16rpx;
      background: #f8fafc;
      border-radius: 8rpx;
      
      .feature-icon {
        font-size: 32rpx;
        margin-right: 16rpx;
      }
      
      .feature-text {
        font-size: 28rpx;
        color: #374151;
      }
    }
  }
}

.back-section {
  text-align: center;
  
  .back-btn {
    background: #6b7280;
    color: white;
    border: none;
    padding: 24rpx 64rpx;
    border-radius: 12rpx;
    font-size: 32rpx;
  }
}
</style>
