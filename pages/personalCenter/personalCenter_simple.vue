<template>
  <view class="personal-center">
    <!-- ç”¨æˆ·ä¿¡æ¯å¤´éƒ¨ - ç®€åŒ–ç‰ˆ -->
    <view class="profile-header">
      <view class="profile-card">
        <view class="avatar-section">
          <image class="avatar" :src="userInfo.avatar || '/static/default-avatar.png'" mode="aspectFill" />
          <view class="user-info">
            <text class="username">{{ userInfo.name || 'æœªè®¾ç½®æ˜µç§°' }}</text>
            <text class="user-level">{{ userInfo.level || 'LV.1 å­¦ä¹ æ–°æ‰‹' }}</text>
          </view>
          <text class="edit-btn" @tap="editProfile">ç¼–è¾‘</text>
        </view>
        
        <view class="stats-section">
          <view class="stat-item">
            <text class="stat-number">{{ userInfo.studyDays || 0 }}</text>
            <text class="stat-label">å¤©</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{ userInfo.studyHours || 0 }}</text>
            <text class="stat-label">å°æ—¶</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{ userInfo.achievements || 0 }}</text>
            <text class="stat-label">æˆå°±</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- å¿«æ·åŠŸèƒ½ -->
    <view class="quick-actions">
      <view class="action-item" @tap="viewCheckinHistory">
        <view class="action-icon">ğŸ“…</view>
        <text class="action-text">æ‰“å¡è®°å½•</text>
      </view>
      <view class="action-item" @tap="viewMyGroups">
        <view class="action-icon">ğŸ‘¥</view>
        <text class="action-text">æˆ‘çš„ç¾¤ç»„</text>
      </view>
      <view class="action-item" @tap="viewStudyReport">
        <view class="action-icon">ğŸ“Š</view>
        <text class="action-text">å­¦ä¹ ç»Ÿè®¡</text>
      </view>
      <view class="action-item" @tap="openSettings">
        <view class="action-icon">âš™ï¸</view>
        <text class="action-text">è®¾ç½®</text>
      </view>
    </view>
    
    <!-- ä¸»è¦åŠŸèƒ½èœå• - ç²¾ç®€ç‰ˆ -->
    <view class="menu-section">
      <view class="menu-item" @tap="viewAchievements">
        <view class="menu-left">
          <view class="menu-icon">ğŸ†</view>
          <text class="menu-text">æˆ‘çš„æˆå°±</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
      
      <view class="menu-item" @tap="openHelp">
        <view class="menu-left">
          <view class="menu-icon">â“</view>
          <text class="menu-text">å¸®åŠ©ä¸­å¿ƒ</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
      
      <view class="menu-item" @tap="aboutApp">
        <view class="menu-left">
          <view class="menu-icon">â„¹ï¸</view>
          <text class="menu-text">å…³äºåº”ç”¨</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
    </view>
    
    <!-- é€€å‡ºç™»å½• -->
    <view class="logout-section">
      <text class="logout-btn" @tap="logout">é€€å‡ºç™»å½•</text>
    </view>
  </view>
</template>

<script>
export default {
  name: 'PersonalCenterPage',
  data() {
    return {
      userInfo: {
        name: 'å°æ˜',
        level: 'LV.5 å­¦ä¹ è¾¾äºº',
        avatar: '',
        studyDays: 128,
        studyHours: 256,
        achievements: 18
      }
    }
  },
  onLoad() {
    this.loadUserInfo()
  },
  methods: {
    loadUserInfo() {
      // åŠ è½½ç”¨æˆ·ä¿¡æ¯
      try {
        console.log('åŠ è½½ç”¨æˆ·ä¿¡æ¯')
      } catch (error) {
        console.error('åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error)
      }
    },
    
    editProfile() {
      uni.navigateTo({
        url: '/pages/personalCenter/editProfile'
      })
    },
    
    viewAchievements() {
      uni.showToast({
        title: 'æˆå°±ç³»ç»Ÿå¼€å‘ä¸­',
        icon: 'none'
      })
    },
    
    viewStudyReport() {
      uni.showToast({
        title: 'å­¦ä¹ æŠ¥å‘Šå¼€å‘ä¸­',
        icon: 'none'
      })
    },
    
    viewCheckinHistory() {
      uni.navigateTo({
        url: '/pages/checkin/checkin'
      })
    },
    
    viewMyGroups() {
      uni.navigateTo({
        url: '/pages/studyGroups/studyGroups'
      })
    },
    
    openSettings() {
      uni.showToast({
        title: 'è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­',
        icon: 'none'
      })
    },
    
    openHelp() {
      uni.showToast({
        title: 'å¸®åŠ©ä¸­å¿ƒå¼€å‘ä¸­',
        icon: 'none'
      })
    },
    
    aboutApp() {
      uni.showModal({
        title: 'å…³äºåº”ç”¨',
        content: 'å­¦ä¹ ç¾¤ç»„ App v1.0\nä¸“ä¸ºå­¦ä¹ äº¤æµæ‰“é€ çš„ç¤¾äº¤å¹³å°',
        showCancel: false
      })
    },
    
    logout() {
      uni.showModal({
        title: 'ç¡®è®¤é€€å‡º',
        content: 'ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ',
        success: (res) => {
          if (res.confirm) {
            uni.clearStorageSync()
            uni.reLaunch({
              url: '/pages/login/login'
            })
          }
        }
      })
    }
  }
}
</script>

<style lang="scss" scoped>
.personal-center {
  min-height: 100vh;
  background: #f9fafb;
  padding: 32rpx;
}

.profile-header {
  margin-bottom: 48rpx;
  
  .profile-card {
    background: white;
    border-radius: 32rpx;
    padding: 48rpx 32rpx;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    
    .avatar-section {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 48rpx;
      
      .avatar {
        width: 120rpx;
        height: 120rpx;
        border-radius: 60rpx;
        margin-right: 24rpx;
      }
      
      .user-info {
        flex: 1;
        
        .username {
          font-size: 42rpx;
          font-weight: 600;
          color: #1f2937;
          margin-bottom: 8rpx;
        }
        
        .user-level {
          font-size: 28rpx;
          color: #6b7280;
        }
      }
      
      .edit-btn {
        background: #0ea5e9;
        color: white;
        padding: 16rpx 32rpx;
        border-radius: 24rpx;
        font-size: 28rpx;
        font-weight: 500;
      }
    }
    
    .stats-section {
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #e5e7eb;
      padding-top: 32rpx;
      
      .stat-item {
        text-align: center;
        
        .stat-number {
          font-size: 48rpx;
          font-weight: 700;
          color: #0ea5e9;
          display: block;
          margin-bottom: 8rpx;
        }
        
        .stat-label {
          font-size: 24rpx;
          color: #6b7280;
        }
      }
    }
  }
}

.quick-actions {
  display: flex;
  justify-content: space-between;
  margin-bottom: 48rpx;
  
  .action-item {
    flex: 1;
    text-align: center;
    background: white;
    border-radius: 24rpx;
    padding: 32rpx 16rpx;
    margin: 0 8rpx;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
    
    .action-icon {
      font-size: 48rpx;
      margin-bottom: 16rpx;
    }
    
    .action-text {
      font-size: 24rpx;
      color: #4b5563;
      font-weight: 500;
    }
  }
}

.menu-section {
  background: white;
  border-radius: 24rpx;
  margin-bottom: 48rpx;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
  
  .menu-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 32rpx;
    border-bottom: 1px solid #f3f4f6;
    
    &:last-child {
      border-bottom: none;
    }
    
    .menu-left {
      display: flex;
      align-items: center;
      
      .menu-icon {
        font-size: 40rpx;
        margin-right: 24rpx;
      }
      
      .menu-text {
        font-size: 32rpx;
        color: #374151;
        font-weight: 500;
      }
    }
    
    .menu-arrow {
      font-size: 36rpx;
      color: #9ca3af;
    }
  }
}

.logout-section {
  text-align: center;
  
  .logout-btn {
    color: #ef4444;
    font-size: 32rpx;
    font-weight: 500;
    background: white;
    padding: 24rpx 64rpx;
    border-radius: 24rpx;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
  }
}
</style>
