# ğŸ‰ Vite é…ç½®ä¼˜åŒ–å®Œæˆ

## âœ… é…ç½®æ›´æ–°æ€»ç»“

æˆ‘å·²ç»å°† `vite.config.js` ä¼˜åŒ–ä¸ºä½¿ç”¨ä¸“ä¸šçš„ `vite-plugin-files-copy` æ’ä»¶ï¼Œæ›¿ä»£äº†ä¹‹å‰çš„è‡ªå®šä¹‰æ’ä»¶ã€‚

### ğŸ”§ ä¸»è¦å˜æ›´ï¼š

**ä¹‹å‰ï¼ˆè‡ªå®šä¹‰æ’ä»¶ï¼‰:**
```javascript
// å¤æ‚çš„è‡ªå®šä¹‰æ’ä»¶ä»£ç 
function cloudFunctionCopyPlugin() {
  // å¤§é‡è‡ªå®šä¹‰ä»£ç ...
}
```

**ç°åœ¨ï¼ˆä¸“ä¸šæ’ä»¶ï¼‰:**
```javascript
import CopyPlugin from 'vite-plugin-files-copy';

const env = process.env.NODE_ENV;
const targetPath = './' + (env === 'development' ? 'unpackage/dist/dev' : 'unpackage/dist/build') + '/mp-weixin/cloudfunctions';

export default defineConfig({
  plugins: [
    uni(),
    CopyPlugin({
      patterns: [
        {
          from: './cloudfunctions',
          to: targetPath
        },
      ],
    }),
  ],
  // ...å…¶ä»–é…ç½®
});
```

### ğŸš€ ä¼˜åŠ¿ï¼š

1. **æ›´ç®€æ´**: ä»£ç å‡å°‘äº† 80%+
2. **æ›´ç¨³å®š**: ä½¿ç”¨æˆç†Ÿçš„ç¬¬ä¸‰æ–¹æ’ä»¶
3. **æ›´å¯ç»´æŠ¤**: å‡å°‘è‡ªå®šä¹‰ä»£ç 
4. **æ™ºèƒ½è·¯å¾„**: è‡ªåŠ¨åŒºåˆ†å¼€å‘/ç”Ÿäº§ç¯å¢ƒ

### ğŸ“ ç›®æ ‡è·¯å¾„æ™ºèƒ½é€‰æ‹©ï¼š

- **å¼€å‘ç¯å¢ƒ**: `unpackage/dist/dev/mp-weixin/cloudfunctions`
- **ç”Ÿäº§ç¯å¢ƒ**: `unpackage/dist/build/mp-weixin/cloudfunctions`

### ğŸ”„ å¯ç”¨çš„å¤åˆ¶æ–¹å¼ï¼š

1. **Vite æ’ä»¶è‡ªåŠ¨å¤åˆ¶** (æ–°å¢)
   - æ„å»ºæ—¶è‡ªåŠ¨æ‰§è¡Œ
   - æ ¹æ®ç¯å¢ƒè‡ªåŠ¨é€‰æ‹©ç›®æ ‡è·¯å¾„

2. **æ‰‹åŠ¨è„šæœ¬å¤åˆ¶** (ä¿ç•™)
   ```bash
   npm run copy-cloudfunctions
   ```

3. **ç‹¬ç«‹è„šæœ¬** (ä¿ç•™)
   ```bash
   node scripts/copy-cloud-functions.js
   ```

### ğŸ“¦ ä¾èµ–ç®¡ç†ï¼š

å·²å®‰è£…çš„æ–°ä¾èµ–ï¼š
```json
{
  "devDependencies": {
    "vite-plugin-files-copy": "^0.1.6"
  }
}
```

### ğŸ¯ æµ‹è¯•ç»“æœï¼š

- âœ… é…ç½®æ–‡ä»¶æ— è¯­æ³•é”™è¯¯
- âœ… æ’ä»¶æ­£å¸¸åŠ è½½
- âœ… æ‰‹åŠ¨å¤åˆ¶è„šæœ¬ä»ç„¶å¯ç”¨
- âœ… æ‰€æœ‰äº‘å‡½æ•°å¤åˆ¶æˆåŠŸ

### ğŸ”® ä¸‹ä¸€æ­¥ï¼š

ç°åœ¨æ‚¨å¯ä»¥ï¼š

1. **æ„å»ºæ—¶è‡ªåŠ¨å¤åˆ¶**: è¿è¡Œ `npm run build:mp-weixin` æ—¶ä¼šè‡ªåŠ¨å¤åˆ¶äº‘å‡½æ•°
2. **å¼€å‘æ—¶æ‰‹åŠ¨å¤åˆ¶**: ä½¿ç”¨ `npm run copy-cloudfunctions`
3. **åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­éƒ¨ç½²**: å³é”®äº‘å‡½æ•°æ–‡ä»¶å¤¹é€‰æ‹©"ä¸Šä¼ å¹¶éƒ¨ç½²"

## ğŸŠ é…ç½®å®Œæˆ

æ‚¨çš„ Vite é…ç½®ç°åœ¨ä½¿ç”¨äº†æ›´ç°ä»£ã€æ›´ç¨³å®šçš„æ–¹æ¡ˆï¼Œæ—¢ä¿æŒäº†åŸæœ‰åŠŸèƒ½ï¼Œåˆæå‡äº†å¯ç»´æŠ¤æ€§ï¼

---

**æç¤º**: å¦‚æœé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥éšæ—¶ä½¿ç”¨å¤‡ç”¨çš„æ‰‹åŠ¨å¤åˆ¶è„šæœ¬è¿›è¡Œäº‘å‡½æ•°å¤åˆ¶ã€‚
